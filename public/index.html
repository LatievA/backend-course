<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Workouts - Assignment 3</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    input, select, textarea { display:block; margin:6px 0 12px; width:300px; }
    .workout { border:1px solid #ddd; padding:8px; margin-bottom:8px; border-radius:6px; }
  </style>
</head>
<body>
  <h1>Workouts</h1>

  <form id="createForm">
    <label>Title <input name="title" required></label>
    <label>Duration (minutes) <input name="duration" type="number" required></label>
    <label>Difficulty
      <select name="difficulty" required>
        <option>Beginner</option>
        <option>Intermediate</option>
        <option>Advanced</option>
      </select>
    </label>
    <label>Description <textarea name="description"></textarea></label>
    <button type="submit">Create Workout</button>
  </form>

  <h2>Workouts list</h2>
  <div id="list"></div>

<script>
const api = '/api/workouts';

async function load() {
  const res = await fetch(api);
  const data = await res.json();
  const container = document.getElementById('list');
  container.innerHTML = data.map(w => `
    <div class="workout">
      <strong>${w.title}</strong> — ${w.duration} min — ${w.difficulty}<br/>
      <small>Created: ${new Date(w.createdAt).toLocaleString()}</small>
      <p>${w.description || ''}</p>
      <div>Exercises: ${w.exercises?.length || 0}</div>
    </div>
  `).join('');
}

document.getElementById('createForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const fd = new FormData(e.target);
  const body = {
    title: fd.get('title'),
    duration: Number(fd.get('duration')),
    difficulty: fd.get('difficulty'),
    description: fd.get('description')
  };
  const res = await fetch(api, { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify(body) });
  if (res.status === 201) {
    e.target.reset();
    load();
  } else {
    const err = await res.json();
    alert('Error: ' + (err.message || JSON.stringify(err)));
  }
});

load();
</script>
</body>
</html>
